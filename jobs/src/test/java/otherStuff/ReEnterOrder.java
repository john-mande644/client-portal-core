package otherStuff;

import com.owd.core.business.Address;
import com.owd.core.business.Contact;
import com.owd.core.business.order.Order;
import com.owd.core.business.order.OrderUtilities;
import com.owd.core.business.order.ShippingInfo;
import com.owd.core.xml.OrderXMLDoc;
import com.owd.hibernate.HibernateSession;
import com.owd.hibernate.generated.OwdLineItem;
import com.owd.hibernate.generated.OwdOrder;
import org.hibernate.Query;

import java.util.ArrayList;
import java.util.List;

public class ReEnterOrder {

    private static List<orderBean> orderList = new ArrayList<>();

    public static void main(String[] args){

        List<String> l = new ArrayList<>();

        l.add("92748909901174573004929472");
        l.add("92748909901174573004929489");
        l.add("92748909901174573004929496");
        l.add("92748909901174573004929502");
        l.add("92748909901174573004929519");
        l.add("92748909901174573004929526");
        l.add("92748909901174573004929533");
        l.add("92748909901174573004929540");
        l.add("92748909901174573004929557");
        l.add("92748909901174573004929564");
        l.add("92748909901174573004929571");
        l.add("92748909901174573004929588");
        l.add("92748909901174573004929595");
        l.add("92748909901174573004929601");
        l.add("92748909901174573004929618");
        l.add("92748909901174573004929625");
        l.add("92748909901174573004929632");
        l.add("92748909901174573004929649");
        l.add("92748909901174573004929656");
        l.add("92748909901174573004929663");
        l.add("92748909901174573004929670");
        l.add("92748909901174573004929687");
        l.add("92748909901174573004929694");
        l.add("92748909901174573004929700");
        l.add("92748909901174573004929717");
        l.add("92748909901174573004929724");
        l.add("92748909901174573004929731");
        l.add("92748909901174573004929748");
        l.add("92748909901174573004929755");
        l.add("92748909901174573004929762");
        l.add("92748909901174573004929786");
        l.add("92748909901174573004929793");
        l.add("92748909901174573004929809");
        l.add("92748909901174573004929816");
        l.add("92748909901174573004929823");
        l.add("92748909901174573004929830");
        l.add("92748909901174573004929847");
        l.add("92748909901174573004929854");
        l.add("92748909901174573004929861");
        l.add("92748909901174573004929878");
        l.add("92748909901174573004929885");
        l.add("92748909901174573004929892");
        l.add("92748909901174573004929908");
        l.add("92748909901174573004929915");
        l.add("92748909901174573004929922");
        l.add("92748909901174573004929946");
        l.add("92748909901174573004929953");
        l.add("92748909901174573004929960");
        l.add("92748909901174573004929977");
        l.add("92748909901174573004929984");
        l.add("92748909901174573004929991");
        l.add("92748909901174573004930003");
        l.add("92748909901174573004930010");
        l.add("92748909901174573004930027");
        l.add("92748909901174573004930034");
        l.add("92748909901174573004930041");
        l.add("92748909901174573004930058");
        l.add("92748909901174573004930065");
        l.add("92748909901174573004930072");
        l.add("92748909901174573004930089");
        l.add("92748909901174573004930102");
        l.add("92748909901174573004930119");
        l.add("92748909901174573004930126");
        l.add("92748909901174573004930133");
        l.add("92748909901174573004930140");
        l.add("92748909901174573004930157");
        l.add("92748909901174573004930164");
        l.add("92748909901174573004930171");
        l.add("92748909901174573004930188");
        l.add("92748909901174573004930195");
        l.add("92748909901174573004930201");
        l.add("92748909901174573004930218");
        l.add("92748909901174573004930225");
        l.add("92748909901174573004930232");
        l.add("92748909901174573004930249");
        l.add("92748909901174573004930256");
        l.add("92748909901174573004930263");
        l.add("92748909901174573004930270");
        l.add("92748909901174573004930287");
        l.add("92748909901174573004930294");
        l.add("92748909901174573004930300");
        l.add("92748909901174573004930317");
        l.add("92748909901174573004930324");
        l.add("92748909901174573004930348");
        l.add("92748909901174573004930355");
        l.add("92748909901174573004930362");
        l.add("92748909901174573004930379");
        l.add("92748909901174573004930386");
        l.add("92748909901174573004930393");
        l.add("92748909901174573004930409");
        l.add("92748909901174573004930416");
        l.add("92748909901174573004930423");
        l.add("92748909901174573004930430");
        l.add("92748909901174573004930454");
        l.add("92748909901174573004930461");
        l.add("92748909901174573004930485");
        l.add("92748909901174573004930492");
        l.add("92748909901174573004930584");
        l.add("92748909901174573004930591");
        l.add("92748909901174573004930607");
        l.add("92748909901174573004930614");
        l.add("92748909901174573004930621");
        l.add("92748909901174573004930638");
        l.add("92748909901174573004930683");
        l.add("92748909901174573004930690");
        l.add("92748909901174573004930706");
        l.add("92748909901174573004930713");
        l.add("92748909901174573004930720");
        l.add("92748909901174573004930737");
        l.add("92748909901174573004930744");
        l.add("92748909901174573004930751");
        l.add("92748909901174573004930768");
        l.add("92748909901174573004930775");
        l.add("92748909901174573004930782");
        l.add("92748909901174573004930812");
        l.add("92748909901174573004930843");
        l.add("92748909901174573004930904");
        l.add("92748909901174573004930911");
        l.add("92748909901174573004930935");
        l.add("92748909901174573004930959");
        l.add("92748909901174573004930973");
        l.add("92748909901174573004931017");
        l.add("92748909901174573004931079");
        l.add("92748909901174573004931123");
        l.add("92748909901174573004931130");
        l.add("92748909901174573004931192");
        l.add("92748909901174573004931215");
        l.add("92748909901174573004931222");
        l.add("92748909901174573004931253");
        l.add("92748909901174573004931260");
        l.add("92748909901174573004931307");
        l.add("92748909901174573004931314");
        l.add("92748909901174573004931321");
        l.add("92748909901174573004931338");
        l.add("92748909901174573004931345");
        l.add("92748909901174573004931369");
        l.add("92748909901174573004931376");
        l.add("92748909901174573004931390");
        l.add("92748909901174573004931413");
        l.add("92748909901174573004931420");
        l.add("92748909901174573004931437");
        l.add("92748909901174573004931444");
        l.add("92748909901174573004931451");
        l.add("92748909901174573004931468");
        l.add("92748909901174573004931482");
        l.add("92748909901174573004931499");
        l.add("92748909901174573004931505");
        l.add("92748909901174573004931512");
        l.add("92748909901174573004931529");
        l.add("92748909901174573004931536");
        l.add("92748909901174573004931543");
        l.add("92748909901174573004931550");
        l.add("92748909901174573004931567");
        l.add("92748909901174573004931574");
        l.add("92748909901174573004931581");
        l.add("92748909901174573004931604");
        l.add("92748909901174573004931628");
        l.add("92748909901174573004931635");
        l.add("92748909901174573004931642");
        l.add("92748909901174573004931659");
        l.add("92748909901174573004931666");
        l.add("92748909901174573004931673");
        l.add("92748909901174573004931680");
        l.add("92748909901174573004931697");
        l.add("92748909901174573004931703");
        l.add("92748909901174573004931710");
        l.add("92748909901174573004931727");
        l.add("92748909901174573004931734");
        l.add("92748909901174573004931741");
        l.add("92748909901174573004931758");
        l.add("92748909901174573004931765");
        l.add("92748909901174573004931772");
        l.add("92748909901174573004931789");
        l.add("92748909901174573004931796");
        l.add("92748909901174573004931802");
        l.add("92748909901174573004931819");
        l.add("92748909901174573004931826");
        l.add("92748909901174573004931833");
        l.add("92748909901174573004931840");
        l.add("92748909901174573004931857");
        l.add("92748909901174573004931864");
        l.add("92748909901174573004931888");
        l.add("92748909901174573004931895");
        l.add("92748909901174573004931901");
        l.add("92748909901174573004931918");
        l.add("92748909901174573004931925");
        l.add("92748909901174573004931932");
        l.add("92748909901174573004931949");
        l.add("92748909901174573004931956");
        l.add("92748909901174573004931963");
        l.add("92748909901174573004931970");
        l.add("92748909901174573004931987");
        l.add("92748909901174573004931994");
        l.add("92748909901174573004932007");
        l.add("92748909901174573004932014");
        l.add("92748909901174573004932021");
        l.add("92748909901174573004932038");
        l.add("92748909901174573004932045");
        l.add("92748909901174573004932052");
        l.add("92748909901174573004932069");
        l.add("92748909901174573004932076");
        l.add("92748909901174573004932083");
        l.add("92748909901174573004932090");
        l.add("92748909901174573004932106");
        l.add("92748909901174573004932113");
        l.add("92748909901174573004932120");
        l.add("92748909901174573004932137");
        l.add("92748909901174573004932168");
        l.add("92748909901174573004932182");
        l.add("92748909901174573004932212");
        l.add("92748909901174573004932236");
        l.add("92748909901174573004932243");
        l.add("92748909901174573004932274");
        l.add("92748909901174573004932281");
        l.add("92748909901174573004932298");
        l.add("92748909901174573004932304");
        l.add("92748909901174573004932311");
        l.add("92748909901174573004932328");
        l.add("92748909901174573004932335");
        l.add("92748909901174573004932342");
        l.add("92748909901174573004932366");
        l.add("92748909901174573004932373");
        l.add("92748909901174573004932380");
        l.add("92748909901174573004932397");
        l.add("92748909901174573004932403");
        l.add("92748909901174573004932410");
        l.add("92748909901174573004932427");
        l.add("92748909901174573004932434");
        l.add("92748909901174573004932441");
        l.add("92748909901174573004932458");
        l.add("92748909901174573004932465");
        l.add("92748909901174573004932472");
        l.add("92748909901174573004932489");
        l.add("92748909901174573004932496");
        l.add("92748909901174573004932502");
        l.add("92748909901174573004932519");
        l.add("92748909901174573004932526");
        l.add("92748909901174573004932533");
        l.add("92748909901174573004932687");
        l.add("92748909901174573004932694");
        l.add("92748909901174573004932717");
        l.add("92748909901174573004932748");
        l.add("92748909901174573004932755");
        l.add("92748909901174573004932779");
        l.add("92748909901174573004932793");
        l.add("92748909901174573004932816");
        l.add("92748909901174573004932823");
        l.add("92748909901174573004932854");
        l.add("92748909901174573004932892");
        l.add("92748909901174573004932915");
        l.add("92748909901174573004932939");
        l.add("92748909901174573004932953");
        l.add("92748909901174573004932960");
        l.add("92748909901174573004932977");
        l.add("92748909901174573004932984");
        l.add("92748909901174573004932991");
        l.add("92748909901174573004933011");
        l.add("92748909901174573004933028");
        l.add("92748909901174573004933042");
        l.add("92748909901174573004933059");
        l.add("92748909901174573004933066");
        l.add("92748909901174573004933073");
        l.add("92748909901174573004933097");
        l.add("92748909901174573004933103");
        l.add("92748909901174573004933110");
        l.add("92748909901174573004933134");
        l.add("92748909901174573004933158");
        l.add("92748909901174573004933189");
        l.add("92748909901174573004933196");
        l.add("92748909901174573004933219");
        l.add("92748909901174573004933226");
        l.add("92748909901174573004933233");
        l.add("92748909901174573004933240");
        l.add("92748909901174573004933257");
        l.add("92748909901174573004933271");
        l.add("92748909901174573004925986");
        l.add("92748909901174573004925955");
        l.add("92748909901174573004926617");
        l.add("92748909901174573004926570");
        l.add("92748909901174573004930553");
        l.add("92748909901174573004930645");
        l.add("92748909901174573004928550");
        l.add("92748909901174573004928567");
        l.add("92748909901174573004928543");
        l.add("92748909901174573004928727");
        l.add("92748909901174573004926648");
        l.add("92748909901174573004926266");
        l.add("92748909901174573004931611");
        l.add("92748909901174573004926631");
        l.add("92748909901174573004928574");
        l.add("92748909901174573004931383");
        l.add("92748909901174573004930652");
        l.add("92748909901174573004930508");
        l.add("92748909901174573004930805");
        l.add("92748909901174573004925887");
        l.add("92748909901174573004926327");
        l.add("92748909901174573004926563");
        l.add("92748909901174573004926310");
        l.add("92748909901174573004926518");
        l.add("92748909901174573004926662");
        l.add("92748909901174573004926532");
        l.add("92748909901174573004926297");
        l.add("92748909901174573004926549");
        l.add("92748909901174573004926303");
        l.add("92748909901174573004926525");
        l.add("92748909901174573004931598");
        l.add("92748909901174573004930836");
        l.add("92748909901174573004930928");
        l.add("92748909901174573004931109");
        l.add("92748909901174573004926556");
        l.add("92748909901174573004925900");
        l.add("92748909901174573004930522");
        l.add("92748909901174573004930874");
        l.add("92748909901174573004931291");
        l.add("92748909901174573004931024");
        l.add("92748909901174573004931048");
        l.add("92748909901174573004930829");
        l.add("92748909901174573004930669");
        l.add("92748909901174573004926501");
        l.add("92748909901174573004925979");
        l.add("92748909901174573004925962");
        l.add("92748909901174573004929779");
        l.add("92748909901174573004933165");
        l.add("92748909901174573004932571");
        l.add("92748909901174573004931277");
        l.add("92748909901174573004925948");
        l.add("92748909901174573004926587");
        l.add("92748909901174573004931185");
        l.add("92748909901174573004932724");
        l.add("92748909901174573004929380");
        l.add("92748909901174573004931475");
        l.add("92748909901174573004928505");
        l.add("92748909901174573004928710");
        l.add("92748909901174573004928581");
        l.add("92748909901174573004926273");
        l.add("92748909901174573004932946");
        l.add("92748909901174573004930096");
        l.add("92748909901174573004926280");
        l.add("92748909901174573004928734");
        l.add("92748909901174573004930515");
        l.add("92748909901174573004930867");
        l.add("92748909901174573004932847");
        l.add("92748909901174573004932595");
        l.add("92748909901174573004932557");
        l.add("92748909901174573004929939");
        l.add("92748909901174573004933004");
        l.add("92748909901174573004926686");
        l.add("92748909901174573004926259");
        l.add("92748909901174573004926624");
        l.add("92748909901174573004930799");
        l.add("92748909901174573004931154");
        l.add("92748909901174573004930942");
        l.add("92748909901174573004926594");
        l.add("92748909901174573004925931");
        l.add("92748909901174573004925917");
        l.add("92748909901174573004926495");
        l.add("92748909901174573004926679");
        l.add("92748909901174573004930577");
        l.add("92748909901174573004931406");
        l.add("92748909901174573004930898");
        l.add("92748909901174573004925924");
        l.add("92748909901174573004925894");
        l.add("92748909901174573004930560");
        l.add("92748909901174573004929373");
        l.add("92748909901174573004932731");
        l.add("92748909901174573004932786");
        l.add("92748909901174573004931161");
        l.add("92748909901174573004932229");
        l.add("92748909901174573004932267");
        l.add("92748909901174573004931116");
        l.add("92748909901174573004932625");
        l.add("92748909901174573004932601");
        l.add("92748909901174573004928536");
        l.add("92748909901174573004926341");
        l.add("92748909901174573004930966");
        l.add("92748909901174573004931086");
        l.add("92748909901174573004931246");
        l.add("92748909901174573004931178");
        l.add("92748909901174573004932250");
        l.add("92748909901174573004931147");
        l.add("92748909901174573004930980");
        l.add("92748909901174573004930997");
        l.add("92748909901174573004932649");
        l.add("92748909901174573004933202");
        l.add("92748909901174573004932809");
        l.add("92748909901174573004930539");
        l.add("92748909901174573004932151");
        l.add("92748909901174573004931093");
        l.add("92748909901174573004931062");
        l.add("92748909901174573004932618");
        l.add("92748909901174573004933288");
        l.add("92748909901174573004930478");
        l.add("92748909901174573004932175");
        l.add("92748909901174573004931239");
        l.add("92748909901174573004933127");
        l.add("92748909901174573004932656");
        l.add("92748909901174573004931000");
        l.add("92748909901174573004931208");
        l.add("92748909901174573004931284");
        l.add("92748909901174573004932564");
        l.add("92748909901174573004933264");
        l.add("92748909901174573004932670");
        l.add("92748909901174573004932663");
        l.add("92748909901174573004932588");
        l.add("92748909901174573004932885");
        l.add("92748909901174573004926242");
        l.add("92748909901174573004930850");
        l.add("92748909901174573004930881");
        l.add("92748909901174573004930676");
        l.add("92748909901174573004932205");
        l.add("92748909901174573004932199");
        l.add("92748909901174573004931031");
        l.add("92748909901174573004931055");
        l.add("92748909901174573004933141");
        l.add("92748909901174573004933295");
        l.add("92748909901174573004933035");
        l.add("92748909901174573004932762");
        l.add("92748909901174573004932830");
        l.add("92748909901174573004932878");
        l.add("92748909901174573004932922");
        l.add("92748909901174573004932632");
        l.add("92748909901174573004932700");
        l.add("92748909901174573004932540");
        l.add("92748909901174573004933080");
        l.add("92748909901174573004932908");
        l.add("92748909901174573004933172");


        for(String tracking :l){



        orderBean ob = new orderBean();
        try{

            ob.setTracking(tracking);
            OwdOrder order = getOwdOrderFromTracking(tracking);
            System.out.println(order.getOrderRefnum());
            ob.setOrderReference(order.getOrderRefnum());
            ob.setOrderId(createNewOrder(order));



        }catch (Exception e){
            e.printStackTrace();
            ob.setOrderId("error");
        }
        orderList.add(ob);
        HibernateSession.closeSession();
        }

        for(orderBean ob:orderList){
            System.out.println(ob.getTracking()+","+ob.getOrderReference()+","+ob.getOrderId());
        }




    }


    private static String createNewOrder(OwdOrder oorder) throws Exception{

        Order order = new Order(oorder.getClientFkey()+"");

       for(OwdLineItem item:oorder.getLineitems()){

           String sku = getMappedSku(item.getInventoryNum());

           order.addLineItem(sku,item.getQuantityRequest()+"",item.getPrice()+"",item.getTotalPrice()+"",item.getDescription(),"","");
       }

       order.order_refnum = oorder.getOrderRefnum()+"-1";


        ShippingInfo info = new ShippingInfo();
        Address shipa = new Address();
        shipa.company_name = oorder.getShipinfo().getShipCompanyName();
        shipa.setAddress_one(oorder.getShipinfo().getShipAddressOne());
        shipa.setAddress_two(oorder.getShipinfo().getShipAddressTwo());
        shipa.setCity(oorder.getShipinfo().getShipCity());
        shipa.setState(oorder.getShipinfo().getShipState());
        shipa.setZip(oorder.getShipinfo().getShipZip());
        info.setShippingAddress(shipa);
        Contact c = new Contact();
        c.setName(oorder.getShipinfo().getShipFirstName()+" "+oorder.getShipinfo().getShipLastName());
        info.setShippingContact(c);
        order.setShippingInfo(info);




        order.backorder_rule = OrderXMLDoc.kBackOrderAll;
        order.setShippingMethodName(oorder.getShipinfo().getCarrService());
        // order.group_name = "Amazon";
        order.bill_cc_type = "CK";
        order.is_paid = 1;
        order.recalculateBalance();
        try{

             order.saveNewOrder(OrderUtilities.kRequirePayment,false);
        } catch(Exception e){
            e.printStackTrace();
        }

        return order.orderNum;

    }



    private static String getMappedSku(String oldSku) throws Exception{
        String sql = "select newSku from clientTransferData where oldSku = :oldSku";
        Query q = HibernateSession.currentSession().createSQLQuery(sql);
        q.setParameter("oldSku",oldSku);
        List l = q.list();

        if(l.size()>0){
            return l.get(0).toString();
        }
        throw new Exception("Unable to find the sku mapping");
    }

    private static OwdOrder getOwdOrderFromTracking(String tracking) throws Exception{
        String sql = "select order_fkey from owd_order_track where tracking_no = :track";
        Query q = HibernateSession.currentSession().createSQLQuery(sql);
        q.setParameter("track",tracking);
        List l = q.list();

        if(l.size()>0){
            Integer orderId = Integer.parseInt(l.get(0).toString());
            return (OwdOrder) HibernateSession.currentSession().load(OwdOrder.class,orderId);

        }
        throw new Exception("Unable to find order via tracking");





    }
}
