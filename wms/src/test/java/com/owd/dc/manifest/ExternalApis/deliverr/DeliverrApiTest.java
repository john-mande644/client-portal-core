package com.owd.dc.manifest.ExternalApis.deliverr;

import com.owd.dc.manifest.ExternalApis.deliverr.classes.DeliverrResponse;
import org.junit.Test;

import javax.swing.*;
import java.io.ByteArrayInputStream;
import java.util.zip.GZIPInputStream;

import static javax.xml.bind.DatatypeConverter.parseBase64Binary;
import static org.junit.Assert.*;

public class DeliverrApiTest {

    @Test
    public void ZPL_findAndReplace() {

        // Test order 29390003 label string in Base64
        String b64 = "XlhBXkxMMTIxOV5QVzgxMl5QT0leTEg1LDVeQ0kyOF5CWTNeRk8wLDAsMF5HQjgwMSwxMjA3LDIsQiwwXkZTXkZPNDAsMjUsMF5GQjEyMSwxLDAsQywwXkEwTiwyMDMsMjAzXkZERl5GU15GTzIwMywwLDBeR0IwLDIwMywzLEIsMF5GU15GTzQ4MSwzOCwwXkdCMjQzLDExNiwyLEIsMF5GU15GTzQ5Myw1MCwwXkZCMjE5LDQsMCxDLDBeQTBOLDIzLDIzXkZERklSU1QtQ0xBU1MgUEtHXCZVLlMuIFBPU1RBR0UgUEFJRFwmU2hpcHBvXCZlUG9zdGFnZV5GU15GTzMxOCw5NiwwXkZCMTYyLDEsMCxDLDBeQTBOLDIzLDIzXkZEQ29tQmFzUHJpY2VeRlNeRk8wLDIwMywwXkdCODAxLDAsMyxCLDBeRlNeRk8wLDIxNSwwXkZCODAxLDEsMCxDLDBeQTBOLDU3LDU3XkZEVVNQUyBGSVJTVC1DTEFTUyBQS0deRlNeRk8wLDI2NiwwXkdCODAxLDAsMyxCLDBeRlNeRk8yNSwyODcsMF5GQjY2MCwzLDAsTCwwXkEwTiwyMywyM15GRE9XRF9NSVJBTE9NQVwmMzMyNSBNQU5JVE9VIENULlwmTUlSQSBMT01BIENBIDkxNzUyXkZTXkZPNTcyLDI4NywwXkZCMjAzLDIsMCxSLDBeQTBOLDIzLDIzXkZEU2hpcCBEYXRlOiAwNS8xOS8yMFwmV2VpZ2h0OiAyIG96XkZTXkZPMTAxLDQ4NCwwXkZCNjYwLDMsMCxMLDBeQTBOLDMyLDMyXkZESlVEWSBXSUxMSUFNU1wmMjQyMSBNQVJTSEFMTCBDVFwmRVJJRSBDTyA4MDUxNi02NTUwXkZTXkZPMCw4MjEsMF5HQjgwMSwwLDYsQiwwXkZTXkZPMCw4MzMsMF5GQjgwMSwxLDAsQywwXkEwTiwyOSwyOV5GRFVTUFMgVFJBQ0tJTkcgIyBFUF5GU15GTzMxLDg3OCwwXkJDTiwxNTIsTixOLE4sRF5GRDQyMDgwNTE2Pjg5MjAwMTkwMTc1NTQ3NzAwMDIxNzg0MjAzMF5GU15GTzAsMTA1NiwwXkZCODAxLDEsMCxDLDBeQTBOLDI5LDI5XkZEOTIwMCAxOTAxIDc1NTQgNzcwMCAwMjE3IDg0MjAgMzBeRlNeRk8wLDEwODcsMF5HQjgwMSwwLDYsQiwwXkZTXlha";

        String ZPL_expected = "^XA^LL1219^PW812^POI^LH5,5^CI28^BY3^FO0,0,0^GB801,1207,2,B,0^FS^FO40,25,0^FB121,1,0,C," +
                "0^A0N,203,203^FDF^FS^FO203,0,0^GB0,203,3,B,0^FS^FO481,38,0^GB243,116,2,B,0^FS^FO493,50,0^FB219,4,0,C,0^A0N,23,23^FDFIRST-CLASS PKG\\&U.S. POSTAGE PAID\\&Shippo\\&ePostage^FS^FO318,96,0^FB162,1,0,C,0^A0N,23,23^FDComBasPrice^FS^FO0,203,0^GB801,0,3,B,0^FS^FO0,215,0^FB801,1,0,C,0^A0N,57,57^FDUSPS FIRST-CLASS PKG^FS^FO0,266,0^GB801,0,3,B,0^FS^FO25,287,0^FB660,3,0,L,0^A0N,23,23^FDOWD_MIRALOMA\\&3325 MANITOU CT.\\&MIRA LOMA CA 91752^FS^FO572,287,0^FB203,2,0,R,0^A0N,23,23^FDShip Date: 05/19/20\\&Weight: 2 oz^FS^FO101,484,0^FB660,3,0,L,0^A0N,32,32^FDJUDY WILLIAMS\\&2421 MARSHALL CT\\&ERIE CO 80516-6550^FS^FO0,821,0^GB801,0,6,B,0^FS^FO0,833,0^FB801,1,0,C,0^A0N,29,29^FDUSPS TRACKING # EP^FS^FO31,878,0^BCN,152,N,N,N,D^FD42080516>892001901755477000217842030^FS^FO0,1056,0^FB801,1,0,C,0^A0N,29,29^FD9200 1901 7554 7700 0217 8420 30^FS^FO0,1087,0^GB801,0,6,B,0^FS^XZ";

        String ZPL_updated = "^XA^LL1219^PW812^POI^LH5,5^CI28^BY2^FO0,0,0^GB801,1207,2,B,0^FS^FO40,25,0^FB121,1,0,C," +
                "0^A0N,203,203^FDF^FS^FO203,0,0^GB0,203,3,B,0^FS^FO481,38,0^GB243,116,2,B,0^FS^FO493,50,0^FB219,4,0,C,0^A0N,23,23^FDFIRST-CLASS PKG\\&U.S. POSTAGE PAID\\&Shippo\\&ePostage^FS^FO318,96,0^FB162,1,0,C,0^A0N,23,23^FDComBasPrice^FS^FO0,203,0^GB801,0,3,B,0^FS^FO0,215,0^FB801,1,0,C,0^A0N,57,57^FDUSPS FIRST-CLASS PKG^FS^FO0,266,0^GB801,0,3,B,0^FS^FO25,287,0^FB660,3,0,L,0^A0N,23,23^FDOWD_MIRALOMA\\&3325 MANITOU CT.\\&MIRA LOMA CA 91752^FS^FO572,287,0^FB203,2,0,R,0^A0N,23,23^FDShip Date: 05/19/20\\&Weight: 2 oz^FS^FO101,484,0^FB660,3,0,L,0^A0N,32,32^FDJUDY WILLIAMS\\&2421 MARSHALL CT\\&ERIE CO 80516-6550^FS^FO0,821,0^GB801,0,6,B,0^FS^FO0,833,0^FB801,1,0,C,0^A0N,29,29^FDUSPS TRACKING # EP^FS^FO31,878,0^BCN,152,N,N,N,D^FD42080516>892001901755477000217842030^FS^FO0,1056,0^FB801,1,0,C,0^A0N,29,29^FD9200 1901 7554 7700 0217 8420 30^FS^FO0,1087,0^GB801,0,6,B,0^FS^XZ";


        // Original ZPL
        String ZPL = DeliverrApi.Base64_to_ZPL(b64);
        assertEquals (ZPL, ZPL_expected);

        // Replaced with BY2
        String ZPL_BY2 = DeliverrApi.ZPL_findAndReplace(ZPL, "BY3", "BY2");
        assertEquals (ZPL_BY2, ZPL_updated);

        // Convert back to base64
        String res = DeliverrApi.ZPL_to_Base64(ZPL_BY2);
//        System.out.println(res);

    }
}